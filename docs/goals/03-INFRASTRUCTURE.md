# 03 ‚Äî –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

> –í–ª–∞–¥–µ–ª–µ—Ü: Architect / SRE Lead
> –ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: 2026-02-24

---

## –°—Ç—Ä–∞—Ç–µ–≥–∏—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ —Ñ–∞–∑–∞–º

### Phase 1: 100K DAU ‚Äî Vertical + Simple Horizontal

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è | –û—Ü–µ–Ω–∫–∞ —Å—Ç–æ–∏–º–æ—Å—Ç–∏/–º–µ—Å |
|-----------|-------------|---------------------|
| API (Python) | 5 —Å–µ—Ä–≤–∏—Å–æ–≤ + AI Service + Learning Engine | $300 |
| Hot-path (Rust) | 2 –∏–Ω—Å—Ç–∞–Ω—Å–∞ (Phase 4) | $0 (–ø–æ–∫–∞ –Ω–µ—Ç) |
| PostgreSQL | 7 –ë–î (–ø–æ –æ–¥–Ω–æ–π –Ω–∞ —Å–µ—Ä–≤–∏—Å) | $400 |
| Redis | 1 –∏–Ω—Å—Ç–∞–Ω—Å, 16GB (cache + rate limit) | $150 |
| AI API (Gemini Flash) | ~$0.03/user/mo @ 10K MAU | $300 |
| Object Storage (S3/R2) | ~5TB | $100 |
| CDN | Cloudflare Free/Pro | $0-20 |
| **–ò—Ç–æ–≥–æ** | | **~$1,250/–º–µ—Å** |

### Phase 2: 1M DAU ‚Äî Horizontal + Caching Layer

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è | –û—Ü–µ–Ω–∫–∞ |
|-----------|-------------|--------|
| API (Python) | 10-30 –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ –∑–∞ LB | $2,000 |
| Hot-path (Rust) | 5-10 –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ | $1,000 |
| PostgreSQL + Citus | 3 shards + replicas | $3,000 |
| Redis Cluster | 3 nodes, 64GB total | $800 |
| ClickHouse | 2 nodes | $1,000 |
| Meilisearch | 3 nodes | $600 |
| NATS JetStream | 3 nodes cluster | $400 |
| Video CDN | Cloudflare Stream –∏–ª–∏ —Å–≤–æ–π | $2,000 |
| **–ò—Ç–æ–≥–æ** | | **~$11,000/–º–µ—Å** |

### Phase 3: 10M DAU ‚Äî Full Distribution

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è | –û—Ü–µ–Ω–∫–∞ |
|-----------|-------------|--------|
| API (Python) | 50-100+ pods, multi-region | $15,000 |
| Hot-path (Rust) | 20-50 pods | $8,000 |
| PostgreSQL + Citus | 10+ shards, multi-region | $20,000 |
| Redis Cluster | Multi-region, 256GB+ | $5,000 |
| ClickHouse Cluster | 5+ nodes | $8,000 |
| Search Cluster | 10+ nodes | $5,000 |
| NATS/Kafka | Multi-region cluster | $3,000 |
| Video Infrastructure | –°–≤–æ–π transcoding + CDN | $30,000 |
| ML Inference | GPU instances | $10,000 |
| **–ò—Ç–æ–≥–æ** | | **~$100K+/–º–µ—Å** |

---

## TODO: Architect / SRE

### Kubernetes –∏ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è
- [ ] üî¥ –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é: managed K8s (EKS/GKE) vs bare-metal
- [ ] üî¥ –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å namespace —Å—Ç—Ä–∞—Ç–µ–≥–∏—é (–ø–æ –¥–æ–º–µ–Ω–∞–º –∏–ª–∏ –ø–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è–º)
- [ ] üî¥ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å HPA (Horizontal Pod Autoscaler) –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
- [ ] üî¥ –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å resource limits –∏ requests –¥–ª—è Python –∏ Rust —Å–µ—Ä–≤–∏—Å–æ–≤
- [ ] üî¥ –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é multi-region (active-active vs active-passive)

### Database –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
- [x] ‚úÖ Connection pool tuning: configurable min/max (default 5/20) —á–µ—Ä–µ–∑ BaseAppSettings
- [x] ‚úÖ pg_trgm + GIN index –¥–ª—è search (p99: 803ms ‚Üí 84ms)
- [ ] üî¥ –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å shard key –¥–ª—è –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü (users, courses, enrollments)
- [ ] üî¥ –°–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é read replicas (–∫–∞–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã –∫—É–¥–∞)
- [ ] üî¥ –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ–ª–∏—Ç–∏–∫—É connection pooling (PgBouncer –∫–æ–Ω—Ñ–∏–≥)
- [ ] üî¥ –°–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å backup —Å—Ç—Ä–∞—Ç–µ–≥–∏—é (RPO < 1 –º–∏–Ω, RTO < 15 –º–∏–Ω)
- [ ] üî¥ –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é data retention –∏ –∞—Ä—Ö–∏–≤–∞—Ü–∏–∏

### –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- [x] ‚úÖ Redis –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ: course by id, curriculum (cache-aside, TTL 5min) ‚Äî Phase 1.1
- [x] ‚úÖ Redis rate limiting: sliding window per-IP, 100/min ‚Äî Phase 1.2
- [ ] üî¥ –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫—ç—à-—Å—Ç—Ä–∞—Ç–µ–≥–∏—é –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤:
  - –ü–æ–∏—Å–∫–æ–≤—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã ‚Äî Cache-Aside, TTL 1 –º–∏–Ω
  - AI-–æ—Ç–≤–µ—Ç—ã (quiz, flashcards) ‚Äî Cache-Aside, TTL 24h (–æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –ø—Ä–æ–º–ø—Ç—ã)
  - –í–∏–¥–µ–æ-–º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ ‚Äî Cache-Aside, TTL 30 –º–∏–Ω
  - Feed/—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ ‚Äî Pre-computed, TTL 10 –º–∏–Ω
- [ ] üî¥ –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é cache invalidation
- [ ] üî¥ –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å cache warming —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–µ—Ä–≤–∏—Å–∞

> **–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** Redis –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è (course service) –∏ rate limiting (–≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã). –ü–æ–¥–∫–ª—é—á—ë–Ω –∫–æ –≤—Å–µ–º —Å–µ—Ä–≤–∏—Å–∞–º —á–µ—Ä–µ–∑ `redis_url` –≤ `BaseAppSettings`.

### CDN –∏ Edge
- [ ] üî¥ –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å CDN —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –¥–ª—è —Å—Ç–∞—Ç–∏–∫–∏, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –≤–∏–¥–µ–æ
- [ ] üî¥ –û—Ü–µ–Ω–∏—Ç—å edge computing –¥–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ (Cloudflare Workers / Rust WASM)
- [ ] üî¥ –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å cache headers —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- [ ] üî¥ –°–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å image optimization pipeline (WebP/AVIF, resize on-the-fly)

### CI/CD
- [ ] üî¥ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å selective builds –≤ –º–æ–Ω–æ—Ä–µ–ø–µ (—Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã)
- [ ] üî¥ –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –¥–µ–ø–ª–æ—è (canary ‚Üí 5% ‚Üí 25% ‚Üí 100%)
- [ ] üî¥ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å auto-rollback –ø–æ –º–µ—Ç—Ä–∏–∫–∞–º (error rate > 1% ‚Üí rollback)
- [ ] üî¥ –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é database migrations –ø—Ä–∏ zero-downtime deploys

### Disaster Recovery
- [ ] üî¥ –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å RPO/RTO –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
- [ ] üî¥ –ù–∞–ø–∏—Å–∞—Ç—å runbook –¥–ª—è –∫–∞–∂–¥–æ–≥–æ failure —Å—Ü–µ–Ω–∞—Ä–∏—è
- [ ] üî¥ –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å chaos engineering —Ç–µ—Å—Ç—ã (–µ–∂–µ–º–µ—Å—è—á–Ω–æ)
- [ ] üî¥ –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é graceful degradation (—á—Ç–æ –æ—Ç–∫–ª—é—á–∞–µ–º –ø–µ—Ä–≤—ã–º –ø—Ä–∏ –ø–µ—Ä–µ–≥—Ä—É–∑–∫–µ)
