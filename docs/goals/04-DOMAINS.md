# 04 โ ะะพะผะตะฝั ะธ Bounded Contexts

> ะะปะฐะดะตะปะตั: Architect / Principal Developer
> ะะพัะปะตะดะฝะตะต ะพะฑะฝะพะฒะปะตะฝะธะต: 2026-02-20

---

## Domain Map

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                       EDUPLATFORM                                โ
โ                                                                 โ
โ  โโโโโโโโโโโโ  โโโโโโโโโโโโ  โโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ  โ
โ  โ Identity โ  โ  Course   โ  โ  Lesson   โ  โ  Search &    โ  โ
โ  โ & Access โ  โ          โ  โ & Content โ  โ  Discovery   โ  โ
โ  โ   โ     โ  โ   โ     โ  โ   ๐ด      โ  โ    ๐ด        โ  โ
โ  โโโโโโโโโโโโ  โโโโโโโโโโโโ  โโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ  โ
โ                                                                 โ
โ  โโโโโโโโโโโโ  โโโโโโโโโโโโ  โโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ  โ
โ  โEnrollmentโ  โ Payments โ  โ Progress  โ  โNotifications โ  โ
โ  โ   โ     โ  โ   โ     โ  โ   ๐ด      โ  โ    โ        โ  โ
โ  โโโโโโโโโโโโ  โโโโโโโโโโโโ  โโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ  โ
โ                                                                 โ
โ  โโโโโโโโโโโโ  โโโโโโโโโโโโ  โโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ  โ
โ  โ Reviews  โ  โ Teacher  โ  โ  Video    โ  โ  Analytics   โ  โ
โ  โ& Ratings โ  โ  Tools   โ  โ Platform  โ  โ  & Reco      โ  โ
โ  โ   ๐ด     โ  โ   ๐ด     โ  โ   ๐ด      โ  โ    ๐ด        โ  โ
โ  โโโโโโโโโโโโ  โโโโโโโโโโโโ  โโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ  โ
โ                                                                 โ
โ  โโโโโโโโโโโโ  โโโโโโโโโโโโ                                    โ
โ  โModerationโ  โ Support  โ                                    โ
โ  โ& Trust   โ  โ          โ                                    โ
โ  โ   ๐ด     โ  โ   ๐ด     โ                                    โ
โ  โโโโโโโโโโโโ  โโโโโโโโโโโโ                                    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โ = ัะตะฐะปะธะทะพะฒะฐะฝะพ   ๐ด = ะฝะต ัะตะฐะปะธะทะพะฒะฐะฝะพ
```

---

## ะะพะผะตะฝ 1: Identity & Access โ

**ะะธะทะฝะตั-ัะตะปั:** ะะดะธะฝะฐั ัะพัะบะฐ ะฒัะพะดะฐ ะดะปั ัััะดะตะฝัะพะฒ ะธ ะฟัะตะฟะพะดะฐะฒะฐัะตะปะตะน.

| # | ะะฐะดะฐัะฐ | ะัะธะพัะธัะตั | ะกัะฐััั |
|---|--------|-----------|--------|
| 1.1 | ะะพะดะตะปั ะฟะพะปัะทะพะฒะฐัะตะปั (student, teacher) | P0 | โ |
| 1.2 | JWT auth (access token, role + is_verified ะฒ claims) | P0 | โ |
| 1.3 | Register, Login, GET /me | P0 | โ |
| 1.4 | ะะตะดะฐะบัะธัะพะฒะฐะฝะธะต ะฟัะพัะธะปั (name, bio) | P1 | ๐ด |
| 1.5 | Password reset flow | P1 | ๐ด |
| 1.6 | Social login (Google, Telegram) | P2 | ๐ด |
| 1.7 | JWT refresh tokens | P2 | ๐ด |
| 1.8 | Teacher verification flow (ะดะพะบัะผะตะฝัั) | P2 | ๐ด |
| 1.9 | Rate limiting ะธ brute-force protection | P2 | ๐ด |

**ะกะตัะฒะธั:** Identity (:8001)
**ะะปะฐะดะตะฝะธะต ะดะฐะฝะฝัะผะธ:** users

---

## ะะพะผะตะฝ 2: Course โ

**ะะธะทะฝะตั-ัะตะปั:** ะัะตะฟะพะดะฐะฒะฐัะตะปะธ ัะพะทะดะฐัั ะบัััั. ะะฐัะฐะปะพะณ ัะพะดะตัะถะธั 1M+ ะบัััะพะฒ.

| # | ะะฐะดะฐัะฐ | ะัะธะพัะธัะตั | ะกัะฐััั |
|---|--------|-----------|--------|
| 2.1 | ะะพะดะตะปั ะบัััะฐ: title, description, price, level, duration | P0 | โ |
| 2.2 | CRUD ะบัััะพะฒ ั role-based access (only verified teachers) | P0 | โ |
| 2.3 | ะะพะธัะบ ะบัััะพะฒ (ILIKE) | P0 | โ |
| 2.4 | ะะตะดะฐะบัะธัะพะฒะฐะฝะธะต ะบัััะฐ (PUT /courses/:id) | P1 | ๐ด |
| 2.5 | ะฃะดะฐะปะตะฝะธะต / ะฐััะธะฒะฐัะธั ะบัััะฐ | P2 | ๐ด |
| 2.6 | Image/thumbnail ะดะปั ะบัััะฐ | P2 | ๐ด |
| 2.7 | ะะฐัะตะณะพัะธะธ ะบัััะพะฒ | P2 | ๐ด |

**ะกะตัะฒะธั:** Course (:8002)
**ะะปะฐะดะตะฝะธะต ะดะฐะฝะฝัะผะธ:** courses

---

## ะะพะผะตะฝ 3: Lesson & Content ๐ด โ ะะะะขะะงะะกะะะ ะะะะะะ

**ะะธะทะฝะตั-ัะตะปั:** ะััั ัะพััะพะธั ะธะท ััััะบัััะธัะพะฒะฐะฝะฝัั ััะพะบะพะฒ. ะกััะดะตะฝั ะผะพะถะตั ััะธัััั, ะฐ ะฝะต ะฟัะพััะพ ัะผะพััะตัั ะบะฐััะพัะบั.

**ะะพัะตะผั ััะพ ะฑะปะพะบะตั:** ะะตะท ััะพะบะพะฒ ะบััั โ ััะพ ะฟัััะฐั ะพะฑัััะบะฐ. ะะตัะตะณะพ "ะฟัะพัะพะดะธัั", ะฝะตัะตะผั "ััะธัััั". ะะปะฐััะพัะผะฐ ะฝะต ะผะพะถะตั ะฝะฐะทัะฒะฐัััั ััะตะฑะฝะพะน.

| # | ะะฐะดะฐัะฐ | ะัะธะพัะธัะตั | ะกัะฐััั |
|---|--------|-----------|--------|
| 3.1 | **ะะพะดะตะปั: Module (ัะตะบัะธั ะบัััะฐ) + Lesson (ััะพะบ ะฒะฝัััะธ ะผะพะดัะปั)** | P0 | ๐ด |
| 3.2 | **CRUD ะผะพะดัะปะตะน: ะดะพะฑะฐะฒะปะตะฝะธะต/ัะดะฐะปะตะฝะธะต/ะธะทะผะตะฝะตะฝะธะต ะฟะพััะดะบะฐ** | P0 | ๐ด |
| 3.3 | **CRUD ััะพะบะพะฒ: title, content (markdown), video_url, order** | P0 | ๐ด |
| 3.4 | **GET /courses/:id/curriculum โ ะฟัะพะณัะฐะผะผะฐ ะบัััะฐ ะดะปั ัััะดะตะฝัะฐ** | P0 | ๐ด |
| 3.5 | **GET /lessons/:id โ ะฟะพะปััะตะฝะธะต ัะพะดะตัะถะธะผะพะณะพ ััะพะบะฐ** | P0 | ๐ด |
| 3.6 | ะะฐะณััะทะบะฐ ะฒะธะดะตะพ-ัะฐะนะปะพะฒ (Phase 1+) | P2 | ๐ด |
| 3.7 | ะะฐัะตัะธะฐะปั ะบ ััะพะบั: PDF, ัะฐะนะปั, ัััะปะบะธ (Phase 1+) | P2 | ๐ด |

**ะะพะดัะพะด MVP:** ะฃัะพะบะธ โ ััะพ ัะตะบัั (markdown) + ัััะปะบะฐ ะฝะฐ ะฒะธะดะตะพ (YouTube/Vimeo embed). ะะตะท ะทะฐะณััะทะบะธ ัะฐะนะปะพะฒ. ะะตะท ัะพะฑััะฒะตะฝะฝะพะณะพ ะฒะธะดะตะพ-ัะพััะธะฝะณะฐ.

**ะกะตัะฒะธั:** ะะฐััะธัะตะฝะธะต Course Service (:8002) โ ััะพะบะธ ะฟัะธะฝะฐะดะปะตะถะฐั ะบัััั, ะฝะตั ัะผััะปะฐ ะฒัะดะตะปััั ะฒ ะพัะดะตะปัะฝัะน ัะตัะฒะธั.

**ะกัะตะผะฐ ะดะฐะฝะฝัั:**
```sql
-- ะะพะดัะปั (ัะตะบัะธั) ะบัััะฐ
modules (id, course_id, title, order, created_at)

-- ะฃัะพะบ ะฒะฝัััะธ ะผะพะดัะปั
lessons (id, module_id, title, content_type, content, video_url, duration_minutes, order, created_at)
```

---

## ะะพะผะตะฝ 4: Enrollment โ

**ะะธะทะฝะตั-ัะตะปั:** ะะฐะฟะธัั ะฝะฐ ะบััั ะทะฐ 1 ะบะปะธะบ.

| # | ะะฐะดะฐัะฐ | ะัะธะพัะธัะตั | ะกัะฐััั |
|---|--------|-----------|--------|
| 4.1 | POST /enrollments (student only) | P0 | โ |
| 4.2 | GET /enrollments/me (ะผะพะธ ะบัััั) | P0 | โ |
| 4.3 | GET /enrollments/course/:id/count | P0 | โ |
| 4.4 | Duplicate protection (UNIQUE constraint) | P0 | โ |
| 4.5 | ะัะผะตะฝะฐ ะทะฐะฟะธัะธ (unenroll) | P2 | ๐ด |

**ะกะตัะฒะธั:** Enrollment (:8003)
**ะะปะฐะดะตะฝะธะต ะดะฐะฝะฝัะผะธ:** enrollments

---

## ะะพะผะตะฝ 5: Progress & Completion ๐ด โ ะะะะขะะงะะกะะะ ะะะะะะ

**ะะธะทะฝะตั-ัะตะปั:** ะกััะดะตะฝั ะฒะธะดะธั ัะฒะพะน ะฟัะพะณัะตัั. ะะฐะฒะตัััะฝะฝัะต ััะพะบะธ โ % ะฟัะพัะพะถะดะตะฝะธั โ completion.

**ะะพัะตะผั ััะพ ะฑะปะพะบะตั:** ะะตะท ะฟัะพะณัะตััะฐ ะฝะตั ะผะพัะธะฒะฐัะธะธ ะฟัะพะดะพะปะถะฐัั. ะกััะดะตะฝั ะฝะต ะทะฝะฐะตั ะณะดะต ะพััะฐะฝะพะฒะธะปัั, ัะบะพะปัะบะพ ะพััะฐะปะพัั. Stickiness = 0.

| # | ะะฐะดะฐัะฐ | ะัะธะพัะธัะตั | ะกัะฐััั |
|---|--------|-----------|--------|
| 5.1 | **POST /progress/lessons/:id/complete โ ะพัะผะตัะธัั ััะพะบ ะฟัะพะนะดะตะฝะฝัะผ** | P0 | ๐ด |
| 5.2 | **GET /progress/courses/:id โ ะฟัะพะณัะตัั ะฟะพ ะบัััั (lessons done / total)** | P0 | ๐ด |
| 5.3 | **GET /progress/me โ ะฒัะต ะบัััั ั ะฟัะพัะตะฝัะพะผ ะฟัะพัะพะถะดะตะฝะธั** | P0 | ๐ด |
| 5.4 | ะะฒัะพะผะฐัะธัะตัะบะธะน ััะฐััั "completed" ะฟัะธ 100% ะฟัะพะณัะตััะฐ | P0 | ๐ด |
| 5.5 | ะกะตััะธัะธะบะฐั ะฟะพ ะทะฐะฒะตััะตะฝะธะธ (PDF) | P2 | ๐ด |

**ะะพะดัะพะด MVP:** ะัะพััะฐั ัะฐะฑะปะธัะฐ `lesson_progress (student_id, lesson_id, completed_at)`. ะัะพะณัะตัั = COUNT(completed) / COUNT(total_lessons). ะัะธ 100% โ enrollment.status = "completed".

**ะกะตัะฒะธั:** ะะฐััะธัะตะฝะธะต Enrollment Service (:8003) โ ะฟัะพะณัะตัั ะฟัะธะฒัะทะฐะฝ ะบ ะทะฐะฟะธัะธ.

**ะกัะตะผะฐ ะดะฐะฝะฝัั:**
```sql
lesson_progress (id, student_id, lesson_id, course_id, completed_at)
UNIQUE(student_id, lesson_id)
```

---

## ะะพะผะตะฝ 6: Payments โ (mock)

**ะะธะทะฝะตั-ัะตะปั:** ะะฟะปะฐัะฐ ะบัััะพะฒ. MVP: mock (status=completed ััะฐะทั).

| # | ะะฐะดะฐัะฐ | ะัะธะพัะธัะตั | ะกัะฐััั |
|---|--------|-----------|--------|
| 6.1 | POST /payments (mock, always completed) | P0 | โ |
| 6.2 | GET /payments/me, GET /payments/:id | P0 | โ |
| 6.3 | Role check (student only) | P0 | โ |
| 6.4 | ะะฝัะตะณัะฐัะธั Stripe/YooKassa | P2 | ๐ด |
| 6.5 | Split payment (ะฟะปะฐััะพัะผะฐ + teacher) | P2 | ๐ด |
| 6.6 | Payout ัะธััะตะผะฐ | P2 | ๐ด |

**ะกะตัะฒะธั:** Payment (:8004)
**ะะปะฐะดะตะฝะธะต ะดะฐะฝะฝัะผะธ:** payments

---

## ะะพะผะตะฝ 7: Notifications โ

**ะะธะทะฝะตั-ัะตะปั:** In-app ัะฒะตะดะพะผะปะตะฝะธั.

| # | ะะฐะดะฐัะฐ | ะัะธะพัะธัะตั | ะกัะฐััั |
|---|--------|-----------|--------|
| 7.1 | POST /notifications (create + log to stdout) | P0 | โ |
| 7.2 | GET /notifications/me | P0 | โ |
| 7.3 | PATCH /notifications/:id/read | P0 | โ |
| 7.4 | Email-ัะฒะตะดะพะผะปะตะฝะธั | P2 | ๐ด |
| 7.5 | Push-ัะฒะตะดะพะผะปะตะฝะธั | P2 | ๐ด |
| 7.6 | User preferences (ะบะฐะบะธะต ัะฒะตะดะพะผะปะตะฝะธั ะฒะบะปััะตะฝั) | P2 | ๐ด |

**ะกะตัะฒะธั:** Notification (:8005)
**ะะปะฐะดะตะฝะธะต ะดะฐะฝะฝัะผะธ:** notifications

---

## ะะพะผะตะฝ 8: Reviews & Ratings ๐ด

**ะะธะทะฝะตั-ัะตะปั:** ะกะพัะธะฐะปัะฝะพะต ะดะพะบะฐะทะฐัะตะปัััะฒะพ. ะกััะดะตะฝั ะฒะธะดะธั ัะตะนัะธะฝะณ ะบัััะฐ ะฟะตัะตะด ะฟะพะบัะฟะบะพะน.

| # | ะะฐะดะฐัะฐ | ะัะธะพัะธัะตั | ะกัะฐััั |
|---|--------|-----------|--------|
| 8.1 | POST /reviews (student, ัะพะปัะบะพ ะฟะพัะปะต enrollment) | P1 | ๐ด |
| 8.2 | GET /reviews/course/:id (ะพัะทัะฒั ะบัััะฐ) | P1 | ๐ด |
| 8.3 | ะกัะตะดะฝะธะน ัะตะนัะธะฝะณ ะฝะฐ ะบะฐััะพัะบะต ะบัััะฐ | P1 | ๐ด |
| 8.4 | ะะดะธะฝ ะพัะทัะฒ ะฝะฐ ะบััั ะพั ัััะดะตะฝัะฐ (UNIQUE) | P1 | ๐ด |
| 8.5 | ะะพะดะตัะฐัะธั ะพัะทัะฒะพะฒ | P2 | ๐ด |

**ะะพะดัะพะด MVP:** ะัะพััะพะน 1-5 star rating + ัะตะบัั. ะกัะตะดะฝะธะน ัะตะนัะธะฝะณ ััะฐะฝะธััั ะดะตะฝะพัะผะฐะปะธะทะพะฒะฐะฝะฝะพ ะฒ courses.

**ะกัะตะผะฐ ะดะฐะฝะฝัั:**
```sql
reviews (id, student_id, course_id, rating 1-5, comment, created_at)
UNIQUE(student_id, course_id)
-- courses: +avg_rating, +review_count (denormalized)
```

---

## ะะพะผะตะฝ 9: Teacher Tools ๐ด

**ะะธะทะฝะตั-ัะตะปั:** ะัะตะฟะพะดะฐะฒะฐัะตะปั ัะฟัะฐะฒะปัะตั ะบัััะฐะผะธ, ะฒะธะดะธั ััะฐัะธััะธะบั.

| # | ะะฐะดะฐัะฐ | ะัะธะพัะธัะตั | ะกัะฐััั |
|---|--------|-----------|--------|
| 9.1 | **GET /courses/my โ ะบัััั ัะตะบััะตะณะพ teacher ั enrollment count** | P0 | ๐ด |
| 9.2 | **PUT /courses/:id โ ัะตะดะฐะบัะธัะพะฒะฐะฝะธะต ะบัััะฐ** | P0 | ๐ด |
| 9.3 | Teacher dashboard ัััะฐะฝะธัะฐ ะฝะฐ frontend | P1 | ๐ด |
| 9.4 | ะะฝะฐะปะธัะธะบะฐ: students, completion rate, revenue | P2 | ๐ด |
| 9.5 | ะัะพะผะพ-ะธะฝััััะผะตะฝัั: ัะบะธะดะบะธ, ะบัะฟะพะฝั | P3 | ๐ด |

---

## ะะพะผะตะฝ 10: Search & Discovery ๐ด

**ะะธะทะฝะตั-ัะตะปั:** ะกััะดะตะฝั ะฝะฐัะพะดะธั ะฝัะถะฝัะน ะบััั ะทะฐ < 3 ัะตะบัะฝะดั.

| # | ะะฐะดะฐัะฐ | ะัะธะพัะธัะตั | ะกัะฐััั |
|---|--------|-----------|--------|
| 10.1 | ILIKE ะฟะพะธัะบ ะฟะพ title/description | P0 | โ |
| 10.2 | ะคะธะปัััั: ะฟะพ ััะพะฒะฝั, ัะตะฝะต (free/paid), ะบะฐัะตะณะพัะธะธ | P1 | ๐ด |
| 10.3 | ะกะพััะธัะพะฒะบะฐ: ะฟะพ ัะตะนัะธะฝะณั, ะฟะพะฟัะปััะฝะพััะธ, ะฝะพะฒะธะทะฝะต | P1 | ๐ด |
| 10.4 | pg_trgm + GIN index ะดะปั ะฑััััะพะณะพ ะฟะพะธัะบะฐ | P1 | ๐ด |
| 10.5 | Meilisearch ะดะปั ะฟะพะปะฝะพัะตะบััะพะฒะพะณะพ ะฟะพะธัะบะฐ | P2 | ๐ด |
| 10.6 | ะะตะบะพะผะตะฝะดะฐัะธะธ | P3 | ๐ด |

---

## ะะพะผะตะฝั ะฒะฝะต MVP (Phase 2+)

| ะะพะผะตะฝ | ะะฟะธัะฐะฝะธะต | ะะพะณะดะฐ |
|-------|----------|-------|
| Video Platform | Upload + transcode + stream | Phase 2 |
| Messaging | Student โ Teacher Q&A | Phase 2 |
| Analytics & Reco | ClickHouse, ML recommendations | Phase 2 |
| Moderation & Trust | AI content moderation, fraud | Phase 2 |
| Support | Ticketing system | Phase 2 |

---

## ะะฐััะธัะฐ ัะพะฑััะธะน ะผะตะถะดั ะดะพะผะตะฝะฐะผะธ

| ะกะพะฑััะธะต | ะััะพัะฝะธะบ | ะะพะดะฟะธััะธะบะธ |
|---------|----------|-----------|
| `user.registered` | Identity | Notifications |
| `course.created` | Course | Notifications, Search |
| `course.updated` | Course | Search |
| `enrollment.created` | Enrollment | Notifications, Teacher Tools |
| `enrollment.completed` | Enrollment | Notifications, Teacher Tools |
| `lesson.completed` | Progress | Enrollment (update %) |
| `payment.processed` | Payments | Enrollment, Notifications |
| `review.created` | Reviews | Course (update avg_rating), Notifications |

> **MVP:** ะกะพะฑััะธั ัะตะฐะปะธะทััััั ัะตัะตะท ะฟััะผัะต ะฒัะทะพะฒั (ะบะปะธะตะฝั-ะพัะบะตัััะฐัะพั), ะฝะต ัะตัะตะท event bus. NATS JetStream โ Phase 2.
